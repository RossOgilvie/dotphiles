# USEFUL REFERENCE DOCS
# The wiki, obvs, https://wiki.hyprland.org/Configuring
# random config https://github.com/ItsDrike/dotfiles/blob/wayland/home/.config/hypr/hyprland.conf

$hscr = /home/ross/.config/hypr/scripts
	
# AUTOSTARTS
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = /usr/lib/polkit-kde-authentication-agent-1 # For authetication pop-ups

exec-once = /home/ross/.scripts/wallpaper
exec-once = dunst

exec-once = gsettings set $gnome-schema gtk-theme 'Pop-dark'
exec-once = gsettings set $gnome-schema icon-theme 'Pop'
exec-once = gsettings set $gnome-schema cursor-theme 'elementary'
exec-once = gsettings set $gnome-schema font-name 'Fira Mono 12'
exec-once = gsettings set org.gnome.desktop.interface color-scheme prefer-dark

# See https://wiki.hyprland.org/Configuring/Monitors/
monitor=,preferred,auto,auto

input {
kb_layout = ross
# kb_options = compose:ralt
# kb_options = lv3:ralt_switch

# 2 - Cursor focus will be detached from keyboard focus. Clicking on a window will move keyboard focus to that window.
follow_mouse = 2     

touchpad {
natural_scroll = no
tap_button_map = lmr
drag_lock = true
}
}

# My wacom tablet should only map to the laptop screen.
device:wacom-one-by-wacom-m-pen {
output = eDP-1
}

gestures {
workspace_swipe = on
workspace_swipe_distance = 300
}

# I don't know why enabled = no isn't working.
# The name is correct, as verified by changing the output to the other monitor.
# device:elan9008:00-04f3:2e36 {
# enabled = no
# output = HDMI-A-1
# }

general {
gaps_in = 5
gaps_out = 10
border_size = 1
# col.active_border = rgba(33ccffee)
col.active_border = rgba(577bb5ee)
col.inactive_border = rgba(595959aa)

no_cursor_warps = true # cursor warps moves the cursor when the focus moves.

layout = master # set the layout to master, ie, one master window and a bunch of minor windows.

}

decoration {
rounding = 10
blur = 1
blur_size = 3
blur_passes = 1
blur_new_optimizations = on

drop_shadow = yes
shadow_range = 3
shadow_render_power = 3
col.shadow = rgba(1a1a1aee)
}

animations {
enabled = yes

# Some default animations, see https://wiki.hyprland.org/Configuring/Animations/ for more

bezier = myBezier, 0.05, 0.9, 0.1, 1.05

# animation = transition, on/off, speed in 100ms, curve, style
animation = windows, 1, 5, default, slide
# animation = windowsOut, 1, 7, default, popin 80%
animation = border, 1, 10, default
animation = fade, 1, 5, default
animation = workspaces, 1, 7, default, slide
}

dwindle {
# I don't use dwindle, but these are the normal settings.
pseudotile = yes 
preserve_split = yes
}

master {
new_is_master = true
no_gaps_when_only = true
}

misc {
disable_hyprland_logo = true
disable_splash_rendering = true
}

binds {
allow_workspace_cycles=false # this seems like a bug with repeatedly pressing movetoworkspace previous.
}

layerrule = blur,^(rofi)$
layerrule = blur,^(eww)$


# KEY BINDINGS
# The actions are called 'dispatchers' https://wiki.hyprland.org/Configuring/Dispatchers/
$mainMod = SUPER
$MOUSE_LMB = mouse:272
$MOUSE_RMB = mouse:273
$MOUSE_MMB = mouse:274

# BASIC BINDS
bind = $mainMod, Escape, killactive
bind = $mainMod, Delete, exec, hyprctl kill # enter kill mode, like xkill. Cancel out with escape.
bind = $mainMod SHIFT CTRL, Escape, exit

# PROGRAM SPAWNS
bind = , XF86Go, exec, eww-control
bind = $mainMod, XF86Go, exec, nwg-drawer
bind = $mainMod, f, exec, firefox 
bind = $mainMod, o, exec, okular
bind = $mainMod, s, exec, spotify 
bind = $mainMod, t, exec, thunderbird
bind = $mainMod, v, exec, pavucontrol
bind = $mainMod, w, exec, code
bind = $mainMod, x, exec, xournalpp
bind = $mainMod, z, exec, zotero

# FUNCTION KEYS
bind = , F1, exec, /home/ross/.scripts/volume toggle
bind = SHIFT, F1, exec, /home/ross/.scripts/music-control play
bind = , F2, exec, /home/ross/.scripts/volume down
bind = , F3, exec, /home/ross/.scripts/volume up
bind = , F4, exec, /home/ross/.scripts/brightness down
bind = , F5, exec, /home/ross/.scripts/brightness up
bind = , F8, exec, wl-mirror eDP-1
bind = , F12, exec, /home/ross/.scripts/battery
#TODO media keys, which should also cover headset buttons

# SCRATCHPADS
# Use shift to open a new instance, if you kill the original
windowrule = workspace special:terminal, Alacritty
bind = $mainMod, return, togglespecialworkspace, terminal
bind = $mainMod SHIFT, return, exec, alacritty
bind = $mainMod CTRL, return, movetoworkspace, special:terminal
exec-once = alacritty

windowrule = workspace special:calculator, qalculate-gtk
bind = $mainMod, c, togglespecialworkspace, calculator
bind = $mainMod SHIFT, c, exec, qalculate-gtk
bind = $mainMod CTRL, c, movetoworkspace, special:calculator
exec-once = qalculate-gtk

windowrule = workspace special:files, nemo
bind = $mainMod, e, togglespecialworkspace, files
bind = $mainMod SHIFT, e, exec, nemo
bind = $mainMod CTRL, e, movetoworkspace, special:files
exec-once = nemo

# FOCUS AND WINDOW MANIPULATION
# These first four use the master layout specific commands
bind = $mainMod, right, layoutmsg, cyclenext
bind = $mainMod, left, layoutmsg, cycleprev
bind = $mainMod CTRL, right, layoutmsg, swapnext
bind = $mainMod CTRL, left, layoutmsg, swapprev

# Change window property
bind = $mainMod, up, fullscreen
bind = $mainMod, down, togglefloating
bind = $mainMod, asciitilde, exec, $hscr/hypr-despecialise # here I think of a window being in a special workspace as a property rather than a location

# Manipulate monitors
bind = $mainMod, backspace, swapactiveworkspaces, current +1 
bind = $mainMod SHIFT, backspace, focusmonitor, +1
bind = $mainMod CTRL, backspace, movewindow, mon:+1

# Resizing
bindm = $mainMod, $MOUSE_LMB, movewindow
bindm = $mainMod SHIFT, $MOUSE_LMB, resizewindow
binde = $mainMod, equal, resizeactive, 10 0
binde = $mainMod, minus, resizeactive, -10 0

# Switch workspaces with mainMod + [0-9], swapping to current monitor (like xmonad)
bind = $mainMod, 1, exec, $hscr/hypr-swap-workspace 1
bind = $mainMod, 2, exec, $hscr/hypr-swap-workspace 2
bind = $mainMod, 3, exec, $hscr/hypr-swap-workspace 3
bind = $mainMod, 4, exec, $hscr/hypr-swap-workspace 4
bind = $mainMod, 5, exec, $hscr/hypr-swap-workspace 5
bind = $mainMod, 6, exec, $hscr/hypr-swap-workspace 6
bind = $mainMod, tab, workspace, previous

# Move active window to a workspace with mainMod + CTRL + [0-9]
bind = $mainMod CTRL, 1, movetoworkspace, 1
bind = $mainMod CTRL, 2, movetoworkspace, 2
bind = $mainMod CTRL, 3, movetoworkspace, 3
bind = $mainMod CTRL, 4, movetoworkspace, 4
bind = $mainMod CTRL, 5, movetoworkspace, 5
bind = $mainMod CTRL, 6, movetoworkspace, 6
bind = $mainMod CTRL, tab, movetoworkspace, previous
